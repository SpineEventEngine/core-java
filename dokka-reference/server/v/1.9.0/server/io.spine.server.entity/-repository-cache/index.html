<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>RepositoryCache</title>
    <link href="../../../images/logo-icon.svg" rel="icon" type="image/svg">
    <script>var pathToRoot = "../../../";</script>
    <script>const storage = localStorage.getItem("dokka-dark-mode")
    if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    } else {
        const savedDarkMode = JSON.parse(storage)
        if(savedDarkMode === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    }
    </script>
<script type="text/javascript" src="../../../scripts/sourceset_dependencies.js" async="async"></script>
<link href="../../../styles/style.css" rel="Stylesheet">
<link href="../../../styles/jetbrains-mono.css" rel="Stylesheet">
<link href="../../../styles/main.css" rel="Stylesheet">
<link href="../../../styles/prism.css" rel="Stylesheet">
<link href="../../../styles/logo-styles.css" rel="Stylesheet">
<script type="text/javascript" src="../../../scripts/clipboard.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/navigation-loader.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/platform-content-handler.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/main.js" defer="defer"></script>
<script type="text/javascript" src="../../../scripts/prism.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/symbol-parameters-wrapper_deferred.js" defer="defer"></script>
<link href="../../../images/logo-icon.svg">
<link href="../../../styles/custom-styles.css" rel="Stylesheet">
</head>
<body>
<div class="navigation-wrapper" id="navigation-wrapper">
    <div id="leftToggler"><span class="icon-toggler"></span></div>
    <div class="library-name">
            <a href="../../../index.html">
                    <span>server</span>
            </a>
    </div>
    <div>
1.9.0    </div>
    <div class="pull-right d-flex">
        <div class="filter-section" id="filter-section">
                <button class="platform-tag platform-selector jvm-like" data-active="" data-filter=":server:dokkaHtml/main">jvm</button>
        </div>
        <button id="theme-toggle-button"><span id="theme-toggle"></span></button>
        <div id="searchBar"></div>
    </div>
</div>
<div id="container">
    <div id="leftColumn">
        <div id="sideMenu"></div>
    </div>
    <div id="main">
<div class="main-content" data-page-type="classlike" id="content" pageIds="server::io.spine.server.entity/RepositoryCache///PointingToDeclaration//-403166102">
  <div class="breadcrumbs"><a href="../../../index.html">server</a><span class="delimiter">/</span><a href="../index.html">io.spine.server.entity</a><span class="delimiter">/</span><span class="current">RepositoryCache</span></div>
  <div class="cover ">
    <h1 class="cover"><span>Repository</span><wbr></wbr><span><span>Cache</span></span></h1>
    <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server:dokkaHtml/main"><div class="symbol monospace"><span class="token keyword">public </span><span class="token keyword">final </span><span class="token keyword">class </span><a href="index.html">RepositoryCache</a><span class="token operator">&lt;</span>I<span class="token punctuation">, </span>E<span class="token keyword"> extends </span><a href="../-entity/index.html">Entity</a><span class="token operator">&lt;</span><a href="index.html">I</a><span class="token punctuation">, </span><span class="token keyword">? extends </span><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html">Object</a><span class="token operator">&gt;</span><span class="token operator">&gt;</span></div><p class="paragraph">The cache of <code class="lang-kotlin">Entity</code> objects for a certain <code class="lang-kotlin">Repository</code> and <a href="start-caching.html">selected</a> identifiers. </p><p class="paragraph">Reduces the number of both read and write storage operations in cases if more than one message is dispatched to the target entity. The typical scenario looks like this: </p><ol><li>Several messages are being dispatched to the entity. The framework calls <a href="start-caching.html"> startCaching(entityId)</a> method. </li><li>Before dispatching the first message, the repository loads the entity via the cache; the cache executes the read operation, remembers the result and returns the entity. </li><li>The first message is dispatched to the entity. <a href="store.html">store(Entity)</a> method is called. Instead of executing the write operation right away, the cache stores the updated entity in its memory. </li><li>More messages are dispatched to the same entity. Each read operation is served by the cache instead of executing the reads from the underlying storage. Upon entity updates, the changed entity is stored into the cache memory. </li><li>The dispatching of the message batch is completed. The framework calls <a href="stop-caching.html"> stopCaching(entityId)</a> method. Then the cache pushes the updated entity to the underlying storage by executing the write operation. </li></ol><p class="paragraph">The users of this class should keep the number of the simultaneously cached entities reasonable due to a potentially huge significant memory footprint.</p><h4 class="">Parameters</h4><div class="table"><div class="table-row" data-filterable-current=":server:dokkaHtml/main" data-filterable-set=":server:dokkaHtml/main"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><u><span><span>&lt;I&gt;</span></span></u></div></span></div><div><div class="title"><p class="paragraph">the type of <code class="lang-kotlin">Entity</code> identifiers</p></div></div></div></div><div class="table-row" data-filterable-current=":server:dokkaHtml/main" data-filterable-set=":server:dokkaHtml/main"><div class="main-subrow keyValue "><div class=""><span class="inline-flex"><div><u><span><span>&lt;E&gt;</span></span></u></div></span></div><div><div class="title"><p class="paragraph">the type of entity</p></div></div></div></div></div></div></div>
  </div>
  <div class="tabbedcontent">
    <div class="tabs-section" tabs-section="tabs-section"><button class="section-tab" data-active="" data-togglable="CONSTRUCTOR,TYPE,FUNCTION,PROPERTY">Members</button></div>
    <div class="tabs-section-body">
      <div data-togglable="CONSTRUCTOR">
        <h2 class="">Constructors</h2>
        <div class="table"><a data-name="2100538002%2FConstructors%2F-403166102" anchor-label="RepositoryCache" id="2100538002%2FConstructors%2F-403166102" data-filterable-set=":server:dokkaHtml/main"></a>
          <div class="table-row" data-togglable="CONSTRUCTOR" data-filterable-current=":server:dokkaHtml/main" data-filterable-set=":server:dokkaHtml/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="-repository-cache.html"><span>Repository</span><wbr></wbr><span><span>Cache</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="2100538002%2FConstructors%2F-403166102"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server:dokkaHtml/main"><div class="symbol monospace block"><span class="token keyword">public </span><span class="token keyword"></span>void <a href="-repository-cache.html"><span class="token function">RepositoryCache</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter "><span class="token keyword"></span>boolean multitenant<span class="token punctuation">, </span></span><span class="parameter "><span class="token keyword"></span><a href="-load/index.html">RepositoryCache.Load</a><span class="token operator">&lt;</span><a href="index.html">I</a><span class="token punctuation">, </span><a href="index.html">E</a><span class="token operator">&gt;</span> loadFn<span class="token punctuation">, </span></span><span class="parameter "><span class="token keyword"></span><a href="-store/index.html">RepositoryCache.Store</a><span class="token operator">&lt;</span><a href="index.html">E</a><span class="token operator">&gt;</span> storeFn</span></span><span class="token punctuation">)</span></div><div class="brief ">Creates the instance of the cache considering the multi-tenancy setting, the function to load entities and the function to store the entity .</div></div></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div data-togglable="TYPE">
        <h2 class="">Types</h2>
        <div class="table"><a data-name="1945732481%2FClasslikes%2F-403166102" anchor-label="Load" id="1945732481%2FClasslikes%2F-403166102" data-filterable-set=":server:dokkaHtml/main"></a>
          <div class="table-row" data-filterable-current=":server:dokkaHtml/main" data-filterable-set=":server:dokkaHtml/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="-load/index.html"><span><span>Load</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="1945732481%2FClasslikes%2F-403166102"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server:dokkaHtml/main"><div class="symbol monospace"><div class="block"><div class="block"><span class="token annotation builtin">@</span><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/FunctionalInterface.html"><span class="token annotation builtin">FunctionalInterface</span></a><span class="token punctuation">(</span><span class="token punctuation">)</span></div></div><span class="token keyword">public </span><span class="token keyword">interface </span><a href="-load/index.html">Load</a><span class="token operator">&lt;</span>I<span class="token punctuation">, </span>E<span class="token keyword"> extends </span><a href="../-entity/index.html">Entity</a><span class="token operator">&lt;</span><a href="-load/index.html">I</a><span class="token punctuation">, </span><span class="token keyword">? extends </span><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/Object.html">Object</a><span class="token operator">&gt;</span><span class="token operator">&gt;</span><span class="token keyword"> implements </span><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Function.html">Function</a><span class="token operator">&lt;</span><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Function.html">T</a><span class="token punctuation">, </span><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Function.html">R</a><span class="token operator">&gt;</span></div><div class="brief ">A function which loads an <code class="lang-kotlin">Entity</code> by ID from its real repository.</div></div></div>
                </div>
              </div>
            </div>
          </div>
<a data-name="228873658%2FClasslikes%2F-403166102" anchor-label="Store" id="228873658%2FClasslikes%2F-403166102" data-filterable-set=":server:dokkaHtml/main"></a>
          <div class="table-row" data-filterable-current=":server:dokkaHtml/main" data-filterable-set=":server:dokkaHtml/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="-store/index.html"><span><span>Store</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="228873658%2FClasslikes%2F-403166102"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server:dokkaHtml/main"><div class="symbol monospace"><div class="block"><div class="block"><span class="token annotation builtin">@</span><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/lang/FunctionalInterface.html"><span class="token annotation builtin">FunctionalInterface</span></a><span class="token punctuation">(</span><span class="token punctuation">)</span></div></div><span class="token keyword">public </span><span class="token keyword">interface </span><a href="-store/index.html">Store</a><span class="token operator">&lt;</span>E<span class="token keyword"> extends </span><a href="../-entity/index.html">Entity</a><span class="token operator">&gt;</span><span class="token keyword"> implements </span><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Consumer.html">Consumer</a><span class="token operator">&lt;</span><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java.base/java/util/function/Consumer.html">T</a><span class="token operator">&gt;</span></div><div class="brief ">A function which stores the <code class="lang-kotlin">Entity</code> to its real repository.</div></div></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div data-togglable="FUNCTION">
        <h2 class="">Functions</h2>
        <div class="table"><a data-name="420116045%2FFunctions%2F-403166102" anchor-label="load" id="420116045%2FFunctions%2F-403166102" data-filterable-set=":server:dokkaHtml/main"></a>
          <div class="table-row" data-filterable-current=":server:dokkaHtml/main" data-filterable-set=":server:dokkaHtml/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="load.html"><span><span>load</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="420116045%2FFunctions%2F-403166102"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server:dokkaHtml/main"><div class="symbol monospace block"><span class="token keyword">public </span><span class="token keyword">synchronized </span><a href="index.html">E</a> <a href="load.html"><span class="token function">load</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter "><span class="token keyword"></span><a href="index.html">I</a> id</span></span><span class="token punctuation">)</span></div><div class="brief ">Loads the entity by its identifier.</div></div></div>
                </div>
              </div>
            </div>
          </div>
<a data-name="309922980%2FFunctions%2F-403166102" anchor-label="startCaching" id="309922980%2FFunctions%2F-403166102" data-filterable-set=":server:dokkaHtml/main"></a>
          <div class="table-row" data-filterable-current=":server:dokkaHtml/main" data-filterable-set=":server:dokkaHtml/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="start-caching.html"><span>start</span><wbr></wbr><span><span>Caching</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="309922980%2FFunctions%2F-403166102"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server:dokkaHtml/main"><div class="symbol monospace block"><span class="token keyword">public </span><span class="token keyword">synchronized </span>void <a href="start-caching.html"><span class="token function">startCaching</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter "><span class="token keyword"></span><a href="index.html">I</a> id</span></span><span class="token punctuation">)</span></div><div class="brief ">Starts caching the <code class="lang-kotlin">load</code> and <code class="lang-kotlin">store</code> operation results in memory for the given <code class="lang-kotlin">Entity</code> identifier.</div></div></div>
                </div>
              </div>
            </div>
          </div>
<a data-name="454897358%2FFunctions%2F-403166102" anchor-label="stopCaching" id="454897358%2FFunctions%2F-403166102" data-filterable-set=":server:dokkaHtml/main"></a>
          <div class="table-row" data-filterable-current=":server:dokkaHtml/main" data-filterable-set=":server:dokkaHtml/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="stop-caching.html"><span>stop</span><wbr></wbr><span><span>Caching</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="454897358%2FFunctions%2F-403166102"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server:dokkaHtml/main"><div class="symbol monospace block"><span class="token keyword">public </span><span class="token keyword">synchronized </span>void <a href="stop-caching.html"><span class="token function">stopCaching</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter "><span class="token keyword"></span><a href="index.html">I</a> id</span></span><span class="token punctuation">)</span></div><div class="brief ">Stops caching the <code class="lang-kotlin">load</code> and <code class="lang-kotlin">store</code> operations for the <code class="lang-kotlin">Entity</code> with the passed identifier.</div></div></div>
                </div>
              </div>
            </div>
          </div>
<a data-name="-1082229354%2FFunctions%2F-403166102" anchor-label="store" id="-1082229354%2FFunctions%2F-403166102" data-filterable-set=":server:dokkaHtml/main"></a>
          <div class="table-row" data-filterable-current=":server:dokkaHtml/main" data-filterable-set=":server:dokkaHtml/main">
            <div class="main-subrow keyValue ">
              <div class=""><span class="inline-flex">
                  <div><a href="store.html"><span><span>store</span></span></a></div>
<span class="anchor-wrapper"><span class="anchor-icon" pointing-to="-1082229354%2FFunctions%2F-403166102"></span>
                    <div class="copy-popup-wrapper "><span class="copy-popup-icon"></span><span>Link copied to clipboard</span></div>
                  </span></span></div>
              <div>
                <div class="title">
                  <div class="platform-hinted " data-platform-hinted="data-platform-hinted"><div class="content sourceset-dependent-content" data-active="" data-togglable=":server:dokkaHtml/main"><div class="symbol monospace block"><span class="token keyword">public </span><span class="token keyword">synchronized </span>void <a href="store.html"><span class="token function">store</span></a><span class="token punctuation">(</span><span class="parameters "><span class="parameter "><span class="token keyword"></span><a href="index.html">E</a> entity</span></span><span class="token punctuation">)</span></div><div class="brief ">Stores the entity.</div></div></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
      <div class="footer">
        <span class="go-to-top-icon"><a href="#content" id="go-to-top-link"></a></span><span>Copyright 2023, TeamDev</span><span
                class="pull-right"><span>Generated by </span><a
                href="https://github.com/Kotlin/dokka"><span>dokka</span><span class="padded-icon"></span></a></span>
      </div>
    </div>
</div>
</body>
</html>
