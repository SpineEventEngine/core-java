<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>CommandRequest (client 1.7.6 API)</title>
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="CommandRequest (client 1.7.6 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../io/spine/client/CommandFactory.html" title="class in io.spine.client"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../io/spine/client/CompositeEntityStateFilter.html" title="class in io.spine.client"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?io/spine/client/CommandRequest.html" target="_top">Frames</a></li>
<li><a href="CommandRequest.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">io.spine.client</div>
<h2 title="Class CommandRequest" class="title">Class CommandRequest</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../../../io/spine/client/ClientRequest.html" title="class in io.spine.client">io.spine.client.ClientRequest</a></li>
<li>
<ul class="inheritance">
<li>io.spine.client.CommandRequest</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>io.spine.logging.Logging</dd>
</dl>
<hr>
<br>
<pre>public final class <span class="typeNameLabel">CommandRequest</span>
extends <a href="../../../io/spine/client/ClientRequest.html" title="class in io.spine.client">ClientRequest</a>
implements io.spine.logging.Logging</pre>
<div class="block">Allows to post a command optionally subscribing to events that are immediate results
 of handling this command.

 <p>Usage example:
 <pre><code>
 Subscription loginSubscription =
     client.asGuest()
           .command(logInUser)
           .observe(UserLoggedIn.class, (event, context) -&gt; { ... })
           .observe(UserAlreadyLoggedIn.class, (rejection, context) -&gt; { ... })
           .onStreamingError((throwable) -&gt; { ... })
           .post();
 </code></pre>

 <p>The subscription obtained from the <a href="../../../io/spine/client/CommandRequest.html#post--"><code>CommandRequest.post()</code></a> should be cancelled
 to preserve both client-side and server-side resources. The moment of cancelling
 the subscriptions depends on the nature of the posted command and the outcome
 expected by the client application.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>&lt;E extends io.spine.base.EventMessage&gt;<br><a href="../../../io/spine/client/CommandRequest.html" title="class in io.spine.client">CommandRequest</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/spine/client/CommandRequest.html#observe-java.lang.Class-java.util.function.Consumer-">observe</a></span>(java.lang.Class&lt;E&gt;&nbsp;type,
       java.util.function.Consumer&lt;E&gt;&nbsp;consumer)</code>
<div class="block">Adds the passed consumer to the subscribers of the event of the passed type.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>&lt;E extends io.spine.base.EventMessage&gt;<br><a href="../../../io/spine/client/CommandRequest.html" title="class in io.spine.client">CommandRequest</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/spine/client/CommandRequest.html#observe-java.lang.Class-io.spine.client.EventConsumer-">observe</a></span>(java.lang.Class&lt;E&gt;&nbsp;type,
       <a href="../../../io/spine/client/EventConsumer.html" title="interface in io.spine.client">EventConsumer</a>&lt;E&gt;&nbsp;consumer)</code>
<div class="block">Adds the passed event consumer to the subscribers of the event of the passed type.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../io/spine/client/CommandRequest.html" title="class in io.spine.client">CommandRequest</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/spine/client/CommandRequest.html#onConsumingError-io.spine.client.ConsumerErrorHandler-">onConsumingError</a></span>(<a href="../../../io/spine/client/ConsumerErrorHandler.html" title="interface in io.spine.client">ConsumerErrorHandler</a>&lt;io.spine.base.EventMessage&gt;&nbsp;handler)</code>
<div class="block">Assigns a handler for errors occurred in consumers of events.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../io/spine/client/CommandRequest.html" title="class in io.spine.client">CommandRequest</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/spine/client/CommandRequest.html#onServerError-io.spine.client.ServerErrorHandler-">onServerError</a></span>(<a href="../../../io/spine/client/ServerErrorHandler.html" title="interface in io.spine.client">ServerErrorHandler</a>&nbsp;handler)</code>
<div class="block">Assigns a handler for an error occurred on the server-side (such as validation error)
 in response to posting a command.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="../../../io/spine/client/CommandRequest.html" title="class in io.spine.client">CommandRequest</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/spine/client/CommandRequest.html#onStreamingError-io.spine.client.ErrorHandler-">onStreamingError</a></span>(<a href="../../../io/spine/client/ErrorHandler.html" title="interface in io.spine.client">ErrorHandler</a>&nbsp;handler)</code>
<div class="block">Assigns a handler for errors occurred when delivering events.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>com.google.common.collect.ImmutableSet&lt;io.spine.client.Subscription&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/spine/client/CommandRequest.html#post--">post</a></span>()</code>
<div class="block">Subscribes the consumers to events to receive events resulting from the command as
 they happen, then sends the command to the server.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../io/spine/client/CommandRequest.html#postAndForget--">postAndForget</a></span>()</code>
<div class="block">Posts the command without subscribing to events that may be generated during
 the command handling.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.io.spine.client.ClientRequest">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;io.spine.client.<a href="../../../io/spine/client/ClientRequest.html" title="class in io.spine.client">ClientRequest</a></h3>
<code><a href="../../../io/spine/client/ClientRequest.html#client--">client</a>, <a href="../../../io/spine/client/ClientRequest.html#command-io.spine.base.CommandMessage-">command</a>, <a href="../../../io/spine/client/ClientRequest.html#select-java.lang.Class-">select</a>, <a href="../../../io/spine/client/ClientRequest.html#subscribeTo-java.lang.Class-">subscribeTo</a>, <a href="../../../io/spine/client/ClientRequest.html#subscribeToEvent-java.lang.Class-">subscribeToEvent</a>, <a href="../../../io/spine/client/ClientRequest.html#user--">user</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.io.spine.logging.Logging">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;io.spine.logging.Logging</h3>
<code>_config, _debug, _error, _fine, _finer, _finest, _info, _severe, _trace, _warn, debugLevel, errorLevel, logger, loggerFor</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="observe-java.lang.Class-java.util.function.Consumer-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>observe</h4>
<pre>@CanIgnoreReturnValue
public&nbsp;&lt;E extends io.spine.base.EventMessage&gt;&nbsp;<a href="../../../io/spine/client/CommandRequest.html" title="class in io.spine.client">CommandRequest</a>&nbsp;observe(java.lang.Class&lt;E&gt;&nbsp;type,
                                                                                           java.util.function.Consumer&lt;E&gt;&nbsp;consumer)</pre>
<div class="block">Adds the passed consumer to the subscribers of the event of the passed type.</div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>E</code> - the type of the event</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>type</code> - the type of the event message to be received by the consumer</dd>
<dd><code>consumer</code> - the consumer</dd>
</dl>
</li>
</ul>
<a name="observe-java.lang.Class-io.spine.client.EventConsumer-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>observe</h4>
<pre>@CanIgnoreReturnValue
public&nbsp;&lt;E extends io.spine.base.EventMessage&gt;&nbsp;<a href="../../../io/spine/client/CommandRequest.html" title="class in io.spine.client">CommandRequest</a>&nbsp;observe(java.lang.Class&lt;E&gt;&nbsp;type,
                                                                                           <a href="../../../io/spine/client/EventConsumer.html" title="interface in io.spine.client">EventConsumer</a>&lt;E&gt;&nbsp;consumer)</pre>
<div class="block">Adds the passed event consumer to the subscribers of the event of the passed type.</div>
<dl>
<dt><span class="paramLabel">Type Parameters:</span></dt>
<dd><code>E</code> - the type of the event</dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>type</code> - the type of the event message to be received by the consumer</dd>
<dd><code>consumer</code> - the consumer of the event message and its context</dd>
</dl>
</li>
</ul>
<a name="onStreamingError-io.spine.client.ErrorHandler-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>onStreamingError</h4>
<pre>@CanIgnoreReturnValue
public&nbsp;<a href="../../../io/spine/client/CommandRequest.html" title="class in io.spine.client">CommandRequest</a>&nbsp;onStreamingError(<a href="../../../io/spine/client/ErrorHandler.html" title="interface in io.spine.client">ErrorHandler</a>&nbsp;handler)</pre>
<div class="block">Assigns a handler for errors occurred when delivering events.

 <p>If such an error occurs, no more events resulting from the posted command will be
 delivered to the consumers.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../io/spine/client/ClientRequest.html#onStreamingError-io.spine.client.ErrorHandler-">onStreamingError</a></code>&nbsp;in class&nbsp;<code><a href="../../../io/spine/client/ClientRequest.html" title="class in io.spine.client">ClientRequest</a></code></dd>
</dl>
</li>
</ul>
<a name="onConsumingError-io.spine.client.ConsumerErrorHandler-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>onConsumingError</h4>
<pre>@CanIgnoreReturnValue
public&nbsp;<a href="../../../io/spine/client/CommandRequest.html" title="class in io.spine.client">CommandRequest</a>&nbsp;onConsumingError(<a href="../../../io/spine/client/ConsumerErrorHandler.html" title="interface in io.spine.client">ConsumerErrorHandler</a>&lt;io.spine.base.EventMessage&gt;&nbsp;handler)</pre>
<div class="block">Assigns a handler for errors occurred in consumers of events.

 <p>After the passed handler is called, remaining event consumers will get the messages
 as usually. If not specified, the default implementation simply logs the error.</div>
</li>
</ul>
<a name="onServerError-io.spine.client.ServerErrorHandler-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>onServerError</h4>
<pre>@OverridingMethodsMustInvokeSuper
 @CanIgnoreReturnValue
public&nbsp;<a href="../../../io/spine/client/CommandRequest.html" title="class in io.spine.client">CommandRequest</a>&nbsp;onServerError(<a href="../../../io/spine/client/ServerErrorHandler.html" title="interface in io.spine.client">ServerErrorHandler</a>&nbsp;handler)</pre>
<div class="block">Assigns a handler for an error occurred on the server-side (such as validation error)
 in response to posting a command.</div>
<dl>
<dt><span class="overrideSpecifyLabel">Overrides:</span></dt>
<dd><code><a href="../../../io/spine/client/ClientRequest.html#onServerError-io.spine.client.ServerErrorHandler-">onServerError</a></code>&nbsp;in class&nbsp;<code><a href="../../../io/spine/client/ClientRequest.html" title="class in io.spine.client">ClientRequest</a></code></dd>
</dl>
</li>
</ul>
<a name="post--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>post</h4>
<pre>public&nbsp;com.google.common.collect.ImmutableSet&lt;io.spine.client.Subscription&gt;&nbsp;post()</pre>
<div class="block">Subscribes the consumers to events to receive events resulting from the command as
 they happen, then sends the command to the server.

 <p>The returned <code>Subscription</code> instances should be
 <a href="../../../io/spine/client/Subscriptions.html#cancel-io.spine.client.Subscription-">canceled</a> after the requesting code receives
 expected events, or after a reasonable timeout.

 <p>The method returns subscriptions to <a href="../../../io/spine/client/CommandRequest.html#observe-java.lang.Class-io.spine.client.EventConsumer-">events</a>
 that the handling of the command <em>may</em> produce. A command <em>may</em> not be accepted
 for processing by the server, e.g. because of a validation error. In such a case, the
 method would report the error to the configured <a href="../../../io/spine/client/CommandRequest.html#onStreamingError-io.spine.client.ErrorHandler-">error handler</a>, and return an empty set.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>subscription to the <a href="../../../io/spine/client/CommandRequest.html#observe-java.lang.Class-io.spine.client.EventConsumer-">observed events</a>
         if the command was successfully posted, or
         an empty set if posting caused an error</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../io/spine/client/CommandRequest.html#postAndForget--"><code>CommandRequest.postAndForget()</code></a></dd>
<dt><span class="simpleTagLabel">API Note:</span></dt>
<dd>Subscriptions should be cancelled to free up client and server resources
         required for their maintenance. It is not possible to cancel the returned
         subscription in an automatic way because of the following.
         Subscriptions by nature are asynchronous and infinite requests.
         Even that we know expected types of the events produced by the command, only the
         client code "knows" how many of them it expects. Also, some events may not arrive
         because of communication or business logic reasons. That's why the returned
         subscriptions should be cancelled by the client code when it no longer needs it.</dd>
</dl>
</li>
</ul>
<a name="postAndForget--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>postAndForget</h4>
<pre>public&nbsp;void&nbsp;postAndForget()
                   throws java.lang.IllegalStateException</pre>
<div class="block">Posts the command without subscribing to events that may be generated during
 the command handling.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if <a href="../../../io/spine/client/CommandRequest.html#observe-java.lang.Class-io.spine.client.EventConsumer-"><code>CommandRequest.observe(Class, EventConsumer)</code></a> or <a href="../../../io/spine/client/CommandRequest.html#observe-java.lang.Class-java.util.function.Consumer-"><code>CommandRequest.observe(Class, Consumer)</code></a> were
         called in the command request configuration chain before calling this method</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../io/spine/client/CommandRequest.html#post--"><code>CommandRequest.post()</code></a></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../io/spine/client/CommandFactory.html" title="class in io.spine.client"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../io/spine/client/CompositeEntityStateFilter.html" title="class in io.spine.client"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?io/spine/client/CommandRequest.html" target="_top">Frames</a></li>
<li><a href="CommandRequest.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
